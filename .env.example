# Supabase MCP Server - Environment Configuration Example
# Copy this file to .env and fill in your values

# ============================================
# Supabase Connection (Cloud or Self-Hosted)
# ============================================

# Option 1: Full connection URL (recommended)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Option 2: Direct PostgreSQL connection (for self-hosted or advanced use)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DATABASE=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-postgres-password

# PostgreSQL pooled connection (PgBouncer/Supavisor)
POSTGRES_POOLED_PORT=6543

# ============================================
# Dokploy Integration (Optional)
# ============================================

# Dokploy API credentials
DOKPLOY_API_URL=https://your-dokploy-instance.com
DOKPLOY_API_KEY=your-dokploy-api-key

# Dokploy instance name (optional, for multi-instance management)
DOKPLOY_INSTANCE_NAME=production

# ============================================
# MCP Server Configuration
# ============================================

# Server mode (development | production)
NODE_ENV=development

# HTTP Server Mode (for remote access)
# Port for HTTP/SSE server (internal container port)
MCP_PORT=3000

# External port mapping (host:container)
# For VPS/standalone: Use default 3000
# For Dokploy: Use unused port like 3001 (Traefik handles routing)
MCP_EXTERNAL_PORT=3000

# ============================================
# Authentication (Choose ONE method)
# ============================================

# Option 1: OAuth 2.1 (Recommended for Claude Desktop Connectors)
OAUTH_ENABLED=true
OAUTH_CLIENT_ID=supabase-mcp-client
OAUTH_CLIENT_SECRET=your-oauth-client-secret-here
OAUTH_JWT_SECRET=your-jwt-secret-32-chars-min

# Option 2: Simple API Key (for programmatic access)
# MCP_API_KEY=your-secret-api-key-here

# Generate secrets: openssl rand -hex 32

# Logging level (debug | info | warn | error)
LOG_LEVEL=info

# Memory management
MAX_BUFFER_SIZE=524288  # 512KB in bytes
TEMP_FILE_PATH=./.mcp-temp
CLEANUP_INTERVAL=86400  # 24 hours in seconds

# ============================================
# Backup Configuration
# ============================================

# Backup storage path (local filesystem)
BACKUP_PATH=./backups

# S3-compatible storage (optional)
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_BUCKET=supabase-backups
# S3_ACCESS_KEY_ID=your-access-key
# S3_SECRET_ACCESS_KEY=your-secret-key
# S3_REGION=us-east-1

# Backup encryption
# BACKUP_ENCRYPTION_KEY=your-32-character-encryption-key-here

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# ============================================
# Security
# ============================================

# Enable read-only mode (disables all write operations)
READ_ONLY_MODE=false

# Audit log retention (days)
AUDIT_LOG_RETENTION_DAYS=90

# Require confirmation for destructive operations
REQUIRE_CONFIRMATION=true

# ============================================
# Rate Limiting (Dokploy API)
# ============================================

# Rate limit (requests per second)
RATE_LIMIT_RPS=10

# Burst capacity
RATE_LIMIT_BURST=20

# ============================================
# Monitoring & Alerts
# ============================================

# Webhook URL for alerts (optional)
# ALERT_WEBHOOK_URL=https://your-webhook-endpoint.com/alerts

# Connection pool warning threshold (percentage)
CONNECTION_POOL_WARNING_THRESHOLD=90

# ============================================
# Testing (for development only)
# ============================================

# Test database connection
TEST_POSTGRES_HOST=localhost
TEST_POSTGRES_PORT=5432
TEST_POSTGRES_DATABASE=postgres
TEST_POSTGRES_USER=postgres
TEST_POSTGRES_PASSWORD=your-super-secret-and-long-postgres-password

# Test Supabase instance
TEST_SUPABASE_URL=http://localhost:8000
TEST_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNjc1NDAwNDAwLCJleHAiOjE5OTEwNDY0MDB9.Bs24fDdJQk4ahM7kP9aRoFdEvfEVvhfmEVrWgKMV1yY
TEST_SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJvbGUiOiJzZXJ2aWNlX3JvbGUiLCJpYXQiOjE2NzU0MDA0MDAsImV4cCI6MTk5MTA0NjQwMH0.qNYE5Kz1L9-9B-VqYMq3Y8K4Z5X6Y7Q8Z9X0Y1Z2Y3Z
